<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ›µ ç¥¥çœŸä¸€è·äººï½œå¾®å‹é›»å‹•è»ŠçºŒèˆªè¦åŠƒç³»çµ±</title>

<style>
body{
    font-family: Arial;
    background:#0f0f0f;
    color:#fff;
    padding:20px;
}
.container{
    max-width:500px;
    margin:auto;
    background:#1a1a1a;
    padding:20px;
    border-radius:15px;
}
h2{
    text-align:center;
    color:#00ff99;
}
select,button{
    width:100%;
    padding:12px;
    margin-top:10px;
    border-radius:8px;
    border:none;
    font-size:16px;
}
button{
    background:#00ff99;
    color:#000;
    font-weight:bold;
}
.result{
    margin-top:20px;
    padding:15px;
    background:#222;
    border-radius:10px;
    line-height:1.6;
}
.footer{
    margin-top:20px;
    font-size:12px;
    text-align:center;
    color:#aaa;
}
</style>
</head>

<body>

<div class="container">
<h2>ğŸ›µ ç¥¥çœŸä¸€è·äººï½œå¾®å‹é›»å‹•è»ŠçºŒèˆªè¦åŠƒç³»çµ±</h2>

<label>é›»æ± é¡å‹</label>
<select id="batteryType" onchange="updateCapacity()">
<option value="lead">é‰›é…¸é›»æ± </option>
<option value="lithium">é‹°é›»æ± </option>
</select>

<label>é›»å£“</label>
<select id="voltage" onchange="updateCapacity()">
<option value="48">48V</option>
<option value="60">60V</option>
<option value="72">72V</option>
</select>

<label>å®¹é‡</label>
<select id="capacity"></select>

<label>ä½¿ç”¨ç‹€æ³</label>
<select id="age"></select>

<label>é¨ä¹˜ç’°å¢ƒ</label>
<select id="road">
<option value="1">å¹³è·¯é€šå‹¤</option>
<option value="0.9">å¸‚å€èµ°åœ</option>
<option value="0.8">å±±è·¯ / è¼‰é‡</option>
</select>

<button onclick="calculate()">é–‹å§‹è¨ˆç®—</button>

<div class="result" id="output"></div>

<div class="footer">
ç¥¥çœŸä¸€è·äººï½œæœ¬ç³»çµ±ç‚ºå¯¦æˆ°ä¼°ç®—æ¨¡å‹ï¼Œå¯¦éš›çºŒèˆªä¾é¨ä¹˜ç¿’æ…£èˆ‡è»Šæ³ç•¥æœ‰å·®ç•°
</div>
</div>

<script>
function updateCapacity(){
    const batteryType = document.getElementById("batteryType").value;
    const voltage = document.getElementById("voltage").value;
    const capacitySelect = document.getElementById("capacity");
    capacitySelect.innerHTML = "";

    let options = [];

    if(batteryType === "lead"){
        options = [20,30];
        updateAgeOptions(['å…¨æ–°','ä¸€å¹´ä»¥ä¸Š']);
    }else{
        if(voltage == "48"){ options = [20,30,40]; }
        if(voltage == "60"){ options = [20,30,40,50]; }
        if(voltage == "72"){ options = [30,40,50]; }
        updateAgeOptions(['å…¨æ–°','ä½¿ç”¨ç´„1å¹´','ä½¿ç”¨2å¹´ä»¥ä¸Š']);
    }

    options.forEach(function(ah){
        let opt = document.createElement("option");
        opt.value = ah;
        opt.text = ah + "Ah";
        capacitySelect.appendChild(opt);
    });
}

function updateAgeOptions(list){
    const ageSelect = document.getElementById("age");
    ageSelect.innerHTML = "";
    list.forEach(function(item){
        let opt = document.createElement("option");
        if(item === 'å…¨æ–°'){ opt.value = 1; }
        else if(item === 'ä¸€å¹´ä»¥ä¸Š' || item === 'ä½¿ç”¨ç´„1å¹´'){ opt.value = 0.9; }
        else if(item === 'ä½¿ç”¨2å¹´ä»¥ä¸Š'){ opt.value = 0.8; }
        opt.text = item;
        ageSelect.appendChild(opt);
    });
}

function calculate(){
    const voltage = parseInt(document.getElementById("voltage").value);
    const ah = parseInt(document.getElementById("capacity").value);
    const batteryType = document.getElementById("batteryType").value;
    const ageFactor = parseFloat(document.getElementById("age").value);
    const roadFactor = parseFloat(document.getElementById("road").value);

    const rawWh = voltage * ah;
    let efficiency = batteryType === "lead" ? 0.80 : 0.92;
    const effectiveWh = rawWh * efficiency * ageFactor * roadFactor;

    let standardConsumption = 23;
    let powerConsumption = 30;

    if(voltage == 48){
        standardConsumption = 20;
        powerConsumption = 26;
    }
    if(voltage == 60){
        standardConsumption = 23;
        powerConsumption = 30;
    }
    if(voltage == 72){
        standardConsumption = 26;
        powerConsumption = 34;
    }

    let standardRange = (effectiveWh / standardConsumption).toFixed(1);
    let powerRange = (effectiveWh / powerConsumption).toFixed(1);

    // 72V å¯¦æˆ°ä¸Šé™
    if(voltage == 72){
        if(standardRange > 100) standardRange = 100;
        if(powerRange > 88) powerRange = 88;
        if(ageFactor < 1){
            standardRange *= ageFactor;
            powerRange *= ageFactor;
        }
    }

    // é›»æ± è¡°é€€
    let decayHalfYear = 0;
    let decayOneYear = 0;

    if(batteryType === 'lead'){
        decayHalfYear = 10;
        decayOneYear = 20;
    }else{
        decayHalfYear = 7;
        decayOneYear = 15;
    }

    document.getElementById("output").innerHTML = `
    ğŸ”‹ é›»æ± ç¸½é›»é‡ï¼š${rawWh} Wh<br>
    âš™ æœ‰æ•ˆå¯ç”¨é›»é‡ï¼šç´„ ${effectiveWh.toFixed(0)} Wh<br><br>

    ğŸŸ¢ æ¨™æº–é€šå‹¤æ¨¡å¼<br>
    ç´„ ${standardRange} km<br><br>

    ğŸ”´ é«˜è¼¸å‡ºé¨ä¹˜æ¨¡å¼<br>
    ç´„ ${powerRange} km

    <hr>
    ğŸ“‰ é›»æ± è¡°é€€åƒè€ƒï¼š
    - åŠå¹´ï¼šç´„ ${decayHalfYear}%  
    - ä¸€å¹´ï¼šç´„ ${decayOneYear}%

    <p style="font-size:14px; color:#ccc; margin-top:10px;">
    âš ï¸ æé†’ï¼šé›»æ± å£½å‘½æœƒå—åˆ°é¨ä¹˜ç¿’æ…£ã€ç’°å¢ƒç°å¡µã€è¼‰é‡åŠä½¿ç”¨æ–¹å¼å½±éŸ¿ï¼Œæ¯ä½è»Šä¸»çš„é›»æ± è¡°é€€æƒ…æ³å¯èƒ½ä¸åŒã€‚
    </p>
    `;
}

updateCapacity();
</script>

</body>
</html>
